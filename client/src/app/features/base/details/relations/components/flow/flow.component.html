<div class="flex-1 absolute right-4 top-4 z-1 flex gap-2">
  <p-button
    icon="icon icon-zoom-in"
    severity="secondary"
    variant="outlined"
    size="small"
    (click)="zoomIn()"
    styleClass="bg-surface-0!"
  />
  <p-button
    icon="icon icon-zoom-out"
    severity="secondary"
    variant="outlined"
    size="small"
    (click)="zoomOut()"
    styleClass="bg-surface-0!"
  />
  <p-button
    icon="icon icon-fullscreen"
    severity="secondary"
    variant="outlined"
    size="small"
    (click)="fitToScreen()"
    styleClass="bg-surface-0!"
  />
  <p-button
    icon="icon icon-square-square"
    severity="secondary"
    variant="outlined"
    size="small"
    (click)="resetScaleAndCenter()"
    styleClass="bg-surface-0!"
  />
  <div
    class="flex items-center gap-3 pl-3 pr-1 border border-surface-200 rounded-md bg-surface-0 h-8 select-none"
  >
    <span class="text-xs font-semibold text-surface-600 tracking-tight">Presentation Mode</span>
    <p-toggleswitch [(ngModel)]="usePresentationMode" class="scale-80" />
  </div>
</div>

<f-flow fDraggable (fLoaded)="onInitialized()">
  <f-background>
    <f-circle-pattern />
  </f-background>
  <f-line-alignment />
  <f-canvas fZoom [fZoomStep]="0.2">
    @for (node of nodes(); track node.id) {
      <table
        fNode
        fDragHandle
        [fNodeId]="node.id"
        [fNodePosition]="node.position"
        [table]="node.data"
        [usePresentationMode]="usePresentationMode"
      ></table>
    }

    @for (con of connections(); track con.id) {
      <f-connection
        [fConnectionId]="con.id"
        [fOutputId]="con.source"
        [fInputId]="con.target"
        fType="segment"
        fBehavior="fixed"
      >
        <svg
          viewBox="0 0 10 10"
          fMarker
          [type]="eMarkerType.START"
          [height]="10"
          [width]="10"
          [refX]="5"
          [refY]="5"
        >
          <circle cx="5" cy="5" r="2" stroke="none"></circle>
        </svg>
        <svg
          viewBox="0 0 6 6"
          fMarker
          [type]="eMarkerType.END"
          [height]="6"
          [width]="6"
          [refX]="5"
          [refY]="3"
        >
          <path d="M0,0 L6,3 0,6Z" stroke="none"></path>
        </svg>
        <svg
          viewBox="0 0 10 10"
          fMarker
          [type]="eMarkerType.SELECTED_START"
          [height]="10"
          [width]="10"
          [refX]="5"
          [refY]="5"
        >
          <circle cx="5" cy="5" r="2" stroke="none"></circle>
        </svg>
        <svg
          viewBox="0 0 6 6"
          fMarker
          [type]="eMarkerType.SELECTED_END"
          [height]="6"
          [width]="6"
          [refX]="5"
          [refY]="3"
        >
          <path d="M0,0 L6,3 0,6Z" stroke="none"></path>
        </svg>
      </f-connection>
    }
  </f-canvas>
  <f-selection-area />
  <f-minimap [fMinSize]="2000" />
</f-flow>
