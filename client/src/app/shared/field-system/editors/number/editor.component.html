@let fieldName = field().name;
@let fieldDescription = field().description;
@let numberFormat = field().params.presentation?.format?.numberFormat;
@let mode = numberFormat === NumberFormat.Currency ? 'currency' : 'decimal';
@let useGrouping = numberFormat === NumberFormat.Comma || numberFormat === NumberFormat.Currency;
@let currency = field().params.presentation?.format?.currency || 'VND';
@let minFractionDigits = numberFormat === NumberFormat.Currency ? 2 : 0;
@let maxFractionDigits = 5;

<div class="flex flex-col gap-1 w-full">
  @if (label() !== false) {
    <label class="text-sm" [attr.for]="fieldName">
      <p class="flex items-center gap-1">
        <i [class]="field().icon"></i>
        {{ fieldName }}
        @if (field().required) {
          <i class="icon icon-asterisk text-red-500"></i>
        }
      </p>
      @if (fieldDescription) {
        <p class="text-xs text-surface-500">{{ fieldDescription }}</p>
      }
    </label>
  }
  <p-inputnumber
    #input="ngModel"
    [required]="field().required"
    [min]="field().minValue"
    [max]="field().maxValue"
    [inputId]="fieldName"
    [placeholder]="placeholder() ?? 'Input here...'"
    [pAutoFocus]="autoFocus()"
    [readonly]="viewOnly()"
    [(ngModel)]="data"
    [mode]="mode"
    locale="en-US"
    [useGrouping]="useGrouping"
    [minFractionDigits]="minFractionDigits"
    [maxFractionDigits]="maxFractionDigits"
    [currency]="currency"
    fluid
  />
  @if (input.invalid && input.touched) {
    <p-message severity="error" size="small" variant="simple">
      @if (input.hasError('required')) {
        {{ fieldName }} is required.
      }
    </p-message>
  }
</div>
